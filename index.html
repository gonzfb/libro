<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lector EPUB</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.6.1/jszip.min.js"></script>
  <script src="https://unpkg.com/epubjs@0.3.88/dist/epub.min.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #eee;
    }

    #viewer {
      width: 100%;
      height: calc(100vh - 56px);
      background: white;
    }

    #controls {
      height: 56px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      background: #222;
    }

    #controls button {
      background: none;
      color: white;
      border: 1px solid white;
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="viewer"></div>

<div id="controls">
  <button id="prev">◀</button>
  <button id="next">▶</button>
  <button id="smaller">A−</button>
  <button id="bigger">A+</button>
</div>

<script>
  const book = ePub("libro.epub");

  const rendition = book.renderTo("viewer", {
    width: "100%",
    height: "100%",
    flow: "paginated",
    spread: "none"
  });

  rendition.display();

  // Navegación botones
  document.getElementById("prev").onclick = () => rendition.prev();
  document.getElementById("next").onclick = () => rendition.next();

  // Teclado
  document.addEventListener("keydown", e => {
    if (e.key === "ArrowRight") rendition.next();
    if (e.key === "ArrowLeft") rendition.prev();
  });

  // Tamaño de letra
  let fontSize = 100;

  document.getElementById("bigger").onclick = () => {
    fontSize += 10;
    rendition.themes.fontSize(fontSize + "%");
  };

  document.getElementById("smaller").onclick = () => {
    fontSize = Math.max(60, fontSize - 10);
    rendition.themes.fontSize(fontSize + "%");
  };

  // ⚠️ IMPORTANTE: saltar portada automáticamente
  book.ready.then(() => {
    book.locations.generate();
    rendition.display(book.locations.cfiFromPercentage(0.01));
  });
</script>

</body>
</html>
